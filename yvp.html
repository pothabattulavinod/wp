<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://ssl.p.jwpcdn.com/player/v/8.32.0/jwplayer.js"></script>
<script>
  jwplayer.key = 'cLGMn8T20tGvW+0eXPhq4NNmLB57TrscPjd1IyJF84o=';
</script>
<style>
  html, body {
    margin: 0; padding: 0; background: #000;
    width: 100%; height: 100%; overflow: hidden;
    font-family: sans-serif;
  }
  #player { width: 100%; height: 100%; }

  /* HUD overlay */
  #hud {
    position: absolute;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 50px;
    color: #fff;
    font-size: 28px;
    align-items: center;
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
  }
  #hud.visible { opacity: 1; }

  #hud span { background: rgba(0,0,0,0.4); padding: 10px 15px; border-radius: 10px; }
</style>
</head>
<body>
<div id="player"></div>
<div id="hud">
  <span id="playPause">‚ñ∂Ô∏è</span>
  <span id="rewind">‚è™ 10s</span>
  <span id="forward">‚è© 10s</span>
  <span id="cc">üí¨ ON</span>
  <span id="timer">0:00 / 0:00</span>
</div>

<script>
const jwp = jwplayer("player");
const playbackKey = "jw-tv-playback-" + location.href;
const savedPosition = localStorage.getItem(playbackKey);

const hud = document.getElementById('hud');
const playPauseEl = document.getElementById('playPause');
const rewindEl = document.getElementById('rewind');
const forwardEl = document.getElementById('forward');
const ccEl = document.getElementById('cc');
const timerEl = document.getElementById('timer');
let hudTimeout;

// --- JWPlayer Setup ---
jwp.setup({
  file: "https://pothabattulavinod.github.io/pay/og.m3u8",
  type: "hls",
  width: "100%",
  height: "100%",
  controls: true,
  primary: "html5",
  autostart: true,
  preload: "auto",
  tracks: [{
    file: "https://raw.githubusercontent.com/pothabattulavinod/wp/refs/heads/main/og.vtt",
    label: "English",
    kind: "captions",
    "default": true
  }]
});

// Resume playback
jwp.on("ready", () => {
  if (savedPosition) jwp.seek(parseFloat(savedPosition));
  updateTimer();
});

// Save playback position
jwp.on("time", e => {
  localStorage.setItem(playbackKey, e.position);
  updateTimer();
});

// Clear position on complete
jwp.on("complete", () => localStorage.removeItem(playbackKey));

// --- HUD Functions ---
function showHUD() {
  hud.classList.add('visible');
  clearTimeout(hudTimeout);
  hudTimeout = setTimeout(() => hud.classList.remove('visible'), 3000);
}

function updateHUD() {
  playPauseEl.textContent = jwp.getState() === "playing" ? "‚ñ∂Ô∏è" : "‚è∏Ô∏è";
  const ccIndex = jwp.getCurrentCaptions();
  ccEl.textContent = ccIndex === 0 ? "üí¨ OFF" : "üí¨ ON";
}

function updateTimer() {
  const pos = Math.floor(jwp.getPosition());
  const dur = Math.floor(jwp.getDuration());
  const format = t => `${Math.floor(t/60)}:${String(t%60).padStart(2,'0')}`;
  timerEl.textContent = `${format(pos)} / ${format(dur)}`;
}

// --- TV Remote Controls ---
document.addEventListener("keydown", (e) => {
  const state = jwp.getState();
  const pos = jwp.getPosition();
  const dur = jwp.getDuration();

  // Log every key to detect your remote codes
  console.log("TV Key Pressed:", e.keyCode, e.key, e.code);

  // Handle common smart TV media keys
  switch(e.keyCode) {
    case 415: // Play
      if(state === "playing") jwp.pause();
      else jwp.play();
      showHUD();
      updateHUD();
      break;
    case 413: // Stop
      jwp.stop();
      showHUD();
      updateHUD();
      break;
    case 412: // Rewind 10s
      jwp.seek(Math.max(0, pos-10));
      showHUD();
      break;
    case 417: // Forward 10s
      jwp.seek(Math.min(dur, pos+10));
      showHUD();
      break;
    case 448: // Volume Down (optional)
      break;
    case 447: // Volume Up (optional)
      break;
    case 449: // Mute (optional)
      break;
    case 10135: // CC toggle (Samsung example)
    case 46:    // Delete key as fallback
      const ccState = jwp.getCurrentCaptions();
      jwp.setCurrentCaptions(ccState === 0 ? 1 : 0);
      showHUD();
      updateHUD();
      break;
  }
});

// --- Update HUD every second ---
setInterval(updateTimer, 1000);
</script>
</body>
</html>
