<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://ssl.p.jwpcdn.com/player/v/8.32.0/jwplayer.js"></script>
<script>
  jwplayer.key = 'cLGMn8T20tGvW+0eXPhq4NNmLB57TrscPjd1IyJF84o=';
</script>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: #000;
  font-family: sans-serif;
  touch-action: none;
  user-select: none;
}

#player {
  width: 100%;
  height: 100%;
  outline: none;
}

#hud {
  position: absolute;
  bottom: 50px;
  left: 50%;
  transform: translateX(-50%);
  color: #fff;
  font-size: 26px;
  pointer-events: none;
  background: rgba(0,0,0,0.5);
  padding: 8px 15px;
  border-radius: 8px;
  opacity: 0;
  transition: opacity 0.3s;
}

#hud.visible { opacity: 1; }

/* Focus style for TV navigation */
.focusable:focus {
  outline: 3px solid #00ffea;
  border-radius: 6px;
}
</style>
</head>
<body>

<div id="player" tabindex="0" class="focusable"></div>
<div id="hud" tabindex="0" class="focusable">0:00 / 0:00</div>

<script>
const jwp = jwplayer("player");
const hud = document.getElementById("hud");
const playbackKey = "jw-tv-playback-" + location.href;
const savedPosition = localStorage.getItem(playbackKey);
let hudTimeout;

// --- JWPlayer Setup ---
jwp.setup({
  file: "https://pothabattulavinod.github.io/pay/og.m3u8",
  type: "hls",
  width: "100%",
  height: "100%",
  controls: true,
  autostart: true,
  preload: "auto",
  primary: "html5",
  tracks: [{
    file: "https://raw.githubusercontent.com/pothabattulavinod/wp/refs/heads/main/og.vtt",
    label: "English",
    kind: "captions",
    "default": true
  }]
});

// --- Focus player to receive media keys ---
jwp.on('ready', () => {
  const playerEl = document.getElementById('player');
  playerEl.focus();
  if(savedPosition) jwp.seek(parseFloat(savedPosition));
  updateHUD();
});

// --- Save playback position ---
jwp.on('time', e => {
  localStorage.setItem(playbackKey, e.position);
  updateHUD();
});

// --- Clear storage on complete ---
jwp.on('complete', () => localStorage.removeItem(playbackKey));

// --- Update HUD ---
function updateHUD() {
  const pos = Math.floor(jwp.getPosition());
  const dur = Math.floor(jwp.getDuration());
  const format = t => `${Math.floor(t/60)}:${String(t%60).padStart(2,'0')}`;
  hud.textContent = `${format(pos)} / ${format(dur)}`;
}

// --- Show HUD temporarily ---
function showHUD() {
  hud.classList.add('visible');
  clearTimeout(hudTimeout);
  hudTimeout = setTimeout(() => hud.classList.remove('visible'), 3000);
}

// --- TV remote navigation ---
const focusableElements = Array.from(document.querySelectorAll('.focusable'));
let currentFocus = 0;
focusableElements[currentFocus].focus();

window.addEventListener('keydown', e => {
  // Prevent default scroll on arrows
  if([37,38,39,40].includes(e.keyCode)){
    e.preventDefault();
    e.stopPropagation();
    
    // Left/Up = previous, Right/Down = next
    if(e.keyCode === 37 || e.keyCode === 38){
      currentFocus = (currentFocus - 1 + focusableElements.length) % focusableElements.length;
    } else {
      currentFocus = (currentFocus + 1) % focusableElements.length;
    }
    focusableElements[currentFocus].focus();
  }

  // Enter/OK triggers click
  if(e.keyCode === 13 || e.keyCode === 32){
    const focused = document.activeElement;
    if(focused) focused.click();
  }

  // Show HUD on any remote interaction
  showHUD();
});

// --- Update HUD every second ---
setInterval(updateHUD, 1000);
</script>

</body>
</html>
