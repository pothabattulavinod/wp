<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TV Friendly JWPlayer</title>

<script src="https://ssl.p.jwpcdn.com/player/v/8.32.0/jwplayer.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
  jwplayer.key = 'cLGMn8T20tGvW+0eXPhq4NNmLB57TrscPjd1IyJF84o=';
</script>

<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background-color: #000;
    overflow: hidden;
  }

  #player {
    width: 100%;
    height: 100%;
    background-color: #000;
    position: relative;
  }

  /* Disable pointer interaction */
  .jwplayer * {
    pointer-events: none !important;
  }

  /* Custom TV control bar */
  .tv-controls {
    position: absolute;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 30px;
    z-index: 10000;
  }

  .tv-button {
    width: 80px;
    height: 50px;
    background: rgba(255,255,255,0.2);
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    border-radius: 5px;
    cursor: pointer;
    user-select: none;
  }

  .tv-focused {
    outline: 3px solid #ff6347;
    outline-offset: 2px;
  }

  .volume-slider {
    width: 100px;
  }
</style>
</head>
<body>

<div id="player"></div>

<script>
  const jwp = jwplayer('player');
  const pageUrl = window.location.href;
  const playbackKey = `jwplayer-playback-position-${pageUrl}`;
  const savedPosition = localStorage.getItem(playbackKey);

  // --- JWPlayer Setup ---
  jwp.setup({
    aspectratio: "16:9",
    width: "100%",
    height: "100%",
    sources: [{
      file: "https://pothabattulavinod.github.io/pay/og.m3u8",
      type: "hls",
      default: true
    }],
    primary: "html5",
    preload: "auto",
    hlshtml: true,
    html5: { hlsjsConfig: { liveSyncDuration: 3, maxBufferLength: 30 } },
    abr: { enabled: true },
    cast: { enabled: true },
    controls: false, // hide default controls
    displayPlaybackLabel: false,
    tracks: [{
      file: "https://raw.githubusercontent.com/pothabattulavinod/wp/refs/heads/main/og.vtt",
      label: "English",
      kind: "captions",
      "default": true,
      language: "en"
    }],
    fullscreen: { enabled: true }
  });

  // --- Custom TV Controls Overlay ---
  const playerContainer = document.querySelector('#player');
  const controlBar = document.createElement('div');
  controlBar.className = 'tv-controls';
  playerContainer.appendChild(controlBar);

  const controlsConfig = [
    { label: '<< 10s', action: () => jwp.seek(jwp.getPosition() - 10) },
    { label: 'Play/Pause', action: () => {
      jwp.getState() === "playing" ? jwp.pause() : jwp.play();
    }},
    { label: '>> 10s', action: () => jwp.seek(jwp.getPosition() + 10) },
    { label: 'Vol -', action: () => jwp.setVolume(Math.max(0, jwp.getVolume() - 10)) },
    { label: 'Vol +', action: () => jwp.setVolume(Math.min(100, jwp.getVolume() + 10)) },
    { label: 'Fullscreen', action: () => jwp.setFullscreen(true) }
  ];

  const buttons = controlsConfig.map(cfg => {
    const btn = document.createElement('div');
    btn.className = 'tv-button';
    btn.innerText = cfg.label;
    btn.tabIndex = -1;
    btn.onclick = cfg.action;
    controlBar.appendChild(btn);
    return btn;
  });

  // --- TV Remote Navigation ---
  let focusedIndex = 0;
  function updateFocus(index) {
    buttons.forEach(b => b.classList.remove('tv-focused'));
    focusedIndex = (index + buttons.length) % buttons.length;
    buttons[focusedIndex].classList.add('tv-focused');
  }

  updateFocus(0);

  document.addEventListener('keydown', e => {
    switch(e.key) {
      case 'ArrowRight': updateFocus(focusedIndex + 1); break;
      case 'ArrowLeft': updateFocus(focusedIndex - 1); break;
      case 'Enter':
      case ' ':
        buttons[focusedIndex].click();
        break;
    }
    e.preventDefault();
  });

  // --- Playback position ---
  jwp.on('ready', () => {
    if (savedPosition && !isNaN(savedPosition)) jwp.seek(parseFloat(savedPosition));
  });

  jwp.on('time', event => {
    localStorage.setItem(playbackKey, event.position);
  });

  jwp.on('complete', () => {
    localStorage.removeItem(playbackKey);
  });

  // --- hls.js fallback ---
  if (typeof Hls !== "undefined") {
    if (Hls.isSupported()) {
      console.log("✅ hls.js supported");
    } else {
      console.log("ℹ️ Native HLS fallback");
    }
  }
</script>
</body>
</html>
